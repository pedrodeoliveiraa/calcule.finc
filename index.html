<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Hora Extra</title>
    <style>
        :root {
            --primary: #3498db;
            --primary-dark: #2980b9;
            --secondary: #2c3e50;
            --light: #f5f7fa;
            --dark: #333;
            --success: #2ecc71;
            --danger: #e74c3c;
            --warning: #f39c12;
            --border-radius: 8px;
            --box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .dark-mode {
            --primary: #3498db;
            --primary-dark: #2980b9;
            --secondary: #ecf0f1;
            --light: #2c3e50;
            --dark: #ecf0f1;
            --success: #2ecc71;
            --danger: #e74c3c;
            --warning: #f39c12;
            --box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: var(--dark);
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
            transition: all 0.3s ease;
        }
        
        body.dark-mode {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .dark-mode .container {
            background-color: #34495e;
        }
        
        header {
            background: linear-gradient(to right, var(--secondary), var(--primary));
            color: white;
            padding: 25px 30px;
            text-align: center;
            position: relative;
        }
        
        .header-controls {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
        }
        
        .theme-toggle {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 8px 12px;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .theme-toggle:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 16px;
            opacity: 0.9;
        }
        
        .content {
            display: flex;
            flex-wrap: wrap;
            padding: 0;
        }
        
        .form-section {
            flex: 1;
            min-width: 350px;
            padding: 30px;
            background-color: white;
        }
        
        .dark-mode .form-section {
            background-color: #34495e;
        }
        
        .result-section {
            flex: 1;
            min-width: 350px;
            padding: 30px;
            background-color: var(--light);
        }
        
        .dark-mode .result-section {
            background-color: #2c3e50;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--secondary);
        }
        
        input, select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            font-size: 16px;
            transition: border 0.3s;
            background-color: white;
            color: var(--dark);
        }
        
        .dark-mode input, .dark-mode select {
            background-color: #2c3e50;
            border-color: #4a6572;
            color: var(--dark);
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }
        
        .time-input-group {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .time-input {
            flex: 1;
        }
        
        .time-separator {
            font-weight: bold;
            color: var(--secondary);
        }
        
        .radio-group {
            display: flex;
            gap: 20px;
            margin-top: 10px;
        }
        
        .radio-option {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .radio-option input {
            width: auto;
        }
        
        .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        button {
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: linear-gradient(to right, var(--primary), var(--primary-dark));
        }
        
        .btn-danger {
            background: linear-gradient(to right, var(--danger), #c0392b);
        }
        
        .btn-warning {
            background: linear-gradient(to right, var(--warning), #e67e22);
        }
        
        .btn-secondary {
            background: linear-gradient(to right, #95a5a6, #7f8c8d);
        }
        
        .btn-success {
            background: linear-gradient(to right, var(--success), #27ae60);
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .calendar-container {
            margin-top: 15px;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            padding: 15px;
            background-color: #f9f9f9;
        }
        
        .dark-mode .calendar-container {
            background-color: #2c3e50;
            border-color: #4a6572;
        }
        
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
        }
        
        .calendar-day {
            text-align: center;
            padding: 8px 5px;
            font-weight: bold;
            color: var(--secondary);
            font-size: 12px;
        }
        
        .calendar-date {
            text-align: center;
            padding: 10px 5px;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: all 0.2s;
            background-color: white;
            position: relative;
        }
        
        .dark-mode .calendar-date {
            background-color: #2c3e50;
            color: var(--dark);
        }
        
        .calendar-date:hover {
            background-color: #e3f2fd;
        }
        
        .dark-mode .calendar-date:hover {
            background-color: #3498db;
        }
        
        .calendar-date.selected {
            background-color: var(--primary);
            color: white;
        }
        
        .calendar-date.weekend {
            color: var(--danger);
        }
        
        .calendar-date.other-month {
            color: #ccc;
        }
        
        .calendar-date.after-25 {
            background-color: #ffeaa7;
        }
        
        .dark-mode .calendar-date.after-25 {
            background-color: #e67e22;
            color: white;
        }
        
        .calendar-date.today {
            border: 2px solid var(--success);
        }
        
        .overtime-list {
            margin-top: 20px;
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            padding: 10px;
            background-color: white;
        }
        
        .dark-mode .overtime-list {
            background-color: #2c3e50;
            border-color: #4a6572;
        }
        
        .overtime-item {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            border-bottom: 1px solid #eee;
            align-items: center;
        }
        
        .dark-mode .overtime-item {
            border-bottom-color: #4a6572;
        }
        
        .overtime-item:last-child {
            border-bottom: none;
        }
        
        .overtime-item button {
            flex: 0 0 auto;
            padding: 5px 10px;
            font-size: 12px;
        }
        
        .result {
            margin-top: 20px;
        }
        
        .result h2 {
            color: var(--secondary);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--primary);
        }
        
        .result-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .dark-mode .result-item {
            border-bottom-color: #4a6572;
        }
        
        .result-total {
            font-weight: bold;
            font-size: 18px;
            color: var(--secondary);
            margin-top: 15px;
            padding-top: 15px;
            border-top: 2px solid #ddd;
        }
        
        .dark-mode .result-total {
            border-top-color: #4a6572;
        }
        
        .highlight {
            color: var(--primary-dark);
            font-weight: 700;
        }
        
        .info-box {
            background-color: #e8f4fc;
            border-left: 4px solid var(--primary);
            padding: 15px;
            margin-top: 25px;
            border-radius: 0 var(--border-radius) var(--border-radius) 0;
            font-size: 14px;
        }
        
        .dark-mode .info-box {
            background-color: #1a5276;
            color: var(--dark);
        }
        
        .info-box p {
            margin-bottom: 8px;
        }
        
        .payment-alert {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 var(--border-radius) var(--border-radius) 0;
        }
        
        .dark-mode .payment-alert {
            background-color: #856404;
            color: #ffecb5;
        }
        
        .calculation-steps {
            margin-top: 20px;
            padding: 15px;
            background-color: #f0f8ff;
            border-radius: var(--border-radius);
            border-left: 4px solid var(--primary);
        }
        
        .dark-mode .calculation-steps {
            background-color: #1a5276;
            color: var(--dark);
        }
        
        .calculation-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            cursor: pointer;
        }
        
        .calculation-content {
            transition: all 0.3s ease;
            overflow: hidden;
        }
        
        .calculation-content.collapsed {
            max-height: 0;
            opacity: 0;
        }
        
        .calculation-content.expanded {
            max-height: 500px;
            opacity: 1;
        }
        
        .month-warning {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 10px;
            margin-top: 10px;
            border-radius: 0 var(--border-radius) var(--border-radius) 0;
            font-size: 12px;
        }
        
        .dark-mode .month-warning {
            background-color: #856404;
            color: #ffecb5;
        }
        
        .payment-info {
            background-color: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin-top: 20px;
            border-radius: 0 var(--border-radius) var(--border-radius) 0;
        }
        
        .dark-mode .payment-info {
            background-color: #155724;
            color: #d4edda;
        }
        
        .history-section {
            margin-top: 30px;
            padding: 20px;
            background-color: var(--light);
            border-radius: var(--border-radius);
        }
        
        .dark-mode .history-section {
            background-color: #2c3e50;
        }
        
        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .history-content {
            max-height: 300px;
            overflow-y: auto;
        }
        
        .history-item {
            padding: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .dark-mode .history-item {
            border-bottom-color: #4a6572;
        }
        
        .history-item:last-child {
            border-bottom: none;
        }
        
        @media (max-width: 768px) {
            .content {
                flex-direction: column;
            }
            
            .radio-group {
                flex-direction: column;
                gap: 10px;
            }
            
            .btn-group {
                flex-direction: column;
            }
            
            .header-controls {
                position: static;
                justify-content: center;
                margin-top: 15px;
            }
            
            .time-input-group {
                flex-direction: column;
                gap: 5px;
            }
            
            .time-separator {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Calculadora de Hora Extra</h1>
            <p class="subtitle">Calcule o valor l√≠quido das suas horas extras incluindo todos os descontos</p>
            <div class="header-controls">
                <button class="theme-toggle" id="theme-toggle">üåô Modo Escuro</button>
            </div>
        </header>
        
        <div class="content">
            <div class="form-section">
                <form id="overtime-form">
                    <div class="form-group">
                        <label for="salary">Sal√°rio Bruto Mensal (R$)</label>
                        <input type="number" id="salary" placeholder="Digite seu sal√°rio bruto" required min="0">
                    </div>
                    
                    <div class="form-group">
                        <label for="hours">Quantidade de Horas Extras</label>
                        <div class="time-input-group">
                            <input type="number" id="hours" placeholder="Horas" min="0" max="23" class="time-input">
                            <span class="time-separator">:</span>
                            <input type="number" id="minutes" placeholder="Minutos" min="0" max="59" class="time-input">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Tipo de Hora Extra</label>
                        <div class="radio-group">
                            <div class="radio-option">
                                <input type="radio" id="percent50" name="percent" value="50" checked>
                                <label for="percent50">50% (Dias de semana)</label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="percent100" name="percent" value="100">
                                <label for="percent100">100% (Finais de semana e feriados)</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="date">Data da Hora Extra</label>
                        <input type="text" id="date" placeholder="Clique para selecionar a data" readonly>
                        
                        <div class="calendar-container" id="calendar" style="display: none;">
                            <div class="calendar-header">
                                <button type="button" id="prev-month" class="btn-primary">&lt;</button>
                                <h3 id="current-month">Setembro 2025</h3>
                                <button type="button" id="next-month" class="btn-primary">&gt;</button>
                            </div>
                            <div class="calendar-grid" id="calendar-days">
                                <!-- Dias da semana -->
                                <div class="calendar-day">Dom</div>
                                <div class="calendar-day">Seg</div>
                                <div class="calendar-day">Ter</div>
                                <div class="calendar-day">Qua</div>
                                <div class="calendar-day">Qui</div>
                                <div class="calendar-day">Sex</div>
                                <div class="calendar-day">S√°b</div>
                                <!-- Datas ser√£o inseridas aqui via JavaScript -->
                            </div>
                        </div>
                    </div>
                    
                    <div class="btn-group">
                        <button type="button" id="add-overtime" class="btn-primary">Adicionar Hora Extra</button>
                        <button type="button" id="clear-all" class="btn-warning">Limpar Tudo</button>
                    </div>
                </form>
                
                <div class="overtime-list" id="overtime-list">
                    <!-- Lista de horas extras adicionadas -->
                    <p style="text-align: center; color: #777;">Nenhuma hora extra adicionada</p>
                </div>
                
                <div class="info-box">
                    <p><strong>Informa√ß√µes:</strong> A empresa fecha no dia 25 de cada m√™s.</p>
                    <p>Horas extras ap√≥s o dia 25 ser√£o pagas no m√™s seguinte.</p>
                </div>
            </div>
            
            <div class="result-section">
                <div class="result" id="result">
                    <h2>Resultado do C√°lculo</h2>
                    <div class="result-item">
                        <span>Valor da Hora Normal:</span>
                        <span id="normal-hour-value">R$ 0,00</span>
                    </div>
                    <div class="result-item">
                        <span>Total de Horas Extras:</span>
                        <span id="total-overtime-hours">0 horas</span>
                    </div>
                    <div class="result-item">
                        <span>Total Bruto das Horas Extras:</span>
                        <span id="total-bruto-overtime">R$ 0,00</span>
                    </div>
                    <div class="result-item">
                        <span>Sal√°rio + Horas Extras (Bruto):</span>
                        <span id="total-bruto">R$ 0,00</span>
                    </div>
                    
                    <h3 style="margin-top: 25px; color: var(--secondary);">Descontos Aplicados</h3>
                    <div class="result-item">
                        <span>Adiantamento Salarial (40%):</span>
                        <span id="adiantamento">R$ 0,00</span>
                    </div>
                    <div class="result-item">
                        <span>INSS:</span>
                        <span id="inss">R$ 0,00</span>
                    </div>
                    <div class="result-item">
                        <span>Imposto de Renda:</span>
                        <span id="ir">R$ 0,00</span>
                    </div>
                    
                    <div class="result-item result-total">
                        <span>Total L√≠quido a Receber:</span>
                        <span id="total-liquido" class="highlight">R$ 0,00</span>
                    </div>
                    
                    <div class="payment-info" id="payment-info-box">
                        <p><strong>Informa√ß√µes de Pagamento:</strong></p>
                        <p id="payment-details">Adicione horas extras para ver as informa√ß√µes de pagamento</p>
                    </div>
                    
                    <div class="payment-alert" id="payment-alert" style="display: none;">
                        <p><strong>‚ö†Ô∏è Aten√ß√£o!</strong></p>
                        <p id="alert-message"></p>
                    </div>
                    
                    <div class="calculation-steps">
                        <div class="calculation-header" id="calculation-toggle">
                            <h4>Detalhamento do C√°lculo</h4>
                            <span id="calculation-arrow">‚ñº</span>
                        </div>
                        <div class="calculation-content expanded" id="calculation-details">
                            <!-- Detalhes do c√°lculo ser√£o inseridos aqui -->
                        </div>
                    </div>
                </div>
                
                <div class="history-section">
                    <div class="history-header">
                        <h3>Hist√≥rico de Horas Extras</h3>
                        <div class="btn-group">
                            <button type="button" id="view-history" class="btn-secondary">Ver Hist√≥rico</button>
                            <button type="button" id="clear-history" class="btn-danger">Limpar Hist√≥rico</button>
                        </div>
                    </div>
                    <div class="history-content" id="history-content">
                        <p style="text-align: center; color: #777;">Nenhum hist√≥rico dispon√≠vel</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Vari√°veis globais
        let overtimeEntries = [];
        let currentDate = new Date(2025, 8, 30); // 30/09/2025
        let selectedDate = null;
        let isDarkMode = false;
        
        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            initializeCalendar();
            setupEventListeners();
            loadFromLocalStorage();
            updatePaymentInfo();
            showPaymentAlert();
        });
        
        // Configurar calend√°rio
        function initializeCalendar() {
            updateCalendar();
            
            // Mostrar/ocultar calend√°rio ao clicar no campo de data
            document.getElementById('date').addEventListener('click', function() {
                const calendar = document.getElementById('calendar');
                calendar.style.display = calendar.style.display === 'none' ? 'block' : 'none';
            });
            
            // Navega√ß√£o do calend√°rio
            document.getElementById('prev-month').addEventListener('click', function() {
                currentDate.setMonth(currentDate.getMonth() - 1);
                updateCalendar();
            });
            
            document.getElementById('next-month').addEventListener('click', function() {
                currentDate.setMonth(currentDate.getMonth() + 1);
                updateCalendar();
            });
        }
        
        // Atualizar visualiza√ß√£o do calend√°rio
        function updateCalendar() {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            
            // Atualizar cabe√ßalho do calend√°rio
            const monthNames = ["Janeiro", "Fevereiro", "Mar√ßo", "Abril", "Maio", "Junho",
                "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"];
            document.getElementById('current-month').textContent = `${monthNames[month]} ${year}`;
            
            // Obter primeiro dia do m√™s e √∫ltimo dia do m√™s
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            
            // Obter o dia da semana do primeiro dia (0 = Domingo, 6 = S√°bado)
            const firstDayOfWeek = firstDay.getDay();
            
            // Limpar calend√°rio
            const calendarGrid = document.getElementById('calendar-days');
            // Manter os dias da semana (primeiros 7 elementos)
            while (calendarGrid.children.length > 7) {
                calendarGrid.removeChild(calendarGrid.lastChild);
            }
            
            // Adicionar dias do m√™s anterior (se necess√°rio)
            const prevMonthLastDay = new Date(year, month, 0).getDate();
            for (let i = firstDayOfWeek - 1; i >= 0; i--) {
                const dateElement = document.createElement('div');
                dateElement.className = 'calendar-date other-month';
                dateElement.textContent = prevMonthLastDay - i;
                calendarGrid.appendChild(dateElement);
            }
            
            // Adicionar dias do m√™s atual
            for (let day = 1; day <= lastDay.getDate(); day++) {
                const dateElement = document.createElement('div');
                dateElement.className = 'calendar-date';
                
                // Destacar dias ap√≥s o dia 25
                if (day > 25) {
                    dateElement.classList.add('after-25');
                }
                
                // Destacar dia atual (30/09/2025)
                if (year === 2025 && month === 8 && day === 30) {
                    dateElement.classList.add('today');
                }
                
                dateElement.textContent = day;
                
                // Verificar se √© fim de semana
                const dayOfWeek = new Date(year, month, day).getDay();
                if (dayOfWeek === 0 || dayOfWeek === 6) {
                    dateElement.classList.add('weekend');
                }
                
                // Marcar como selecionado se for a data atual
                if (selectedDate && 
                    selectedDate.getDate() === day && 
                    selectedDate.getMonth() === month && 
                    selectedDate.getFullYear() === year) {
                    dateElement.classList.add('selected');
                }
                
                dateElement.addEventListener('click', function() {
                    selectDate(new Date(year, month, day));
                });
                
                calendarGrid.appendChild(dateElement);
            }
            
            // Adicionar dias do pr√≥ximo m√™s (se necess√°rio)
            const totalCells = 42; // 6 semanas * 7 dias
            const daysInCalendar = firstDayOfWeek + lastDay.getDate();
            const nextMonthDays = totalCells - daysInCalendar;
            
            for (let day = 1; day <= nextMonthDays; day++) {
                const dateElement = document.createElement('div');
                dateElement.className = 'calendar-date other-month';
                dateElement.textContent = day;
                calendarGrid.appendChild(dateElement);
            }
        }
        
        // Selecionar data no calend√°rio
        function selectDate(date) {
            selectedDate = date;
            document.getElementById('date').value = formatDate(date);
            document.getElementById('calendar').style.display = 'none';
            updateCalendar();
            
            // Atualizar automaticamente o tipo de hora extra baseado no dia da semana
            const dayOfWeek = date.getDay();
            const isWeekend = dayOfWeek === 0 || dayOfWeek === 6;
            
            if (isWeekend) {
                document.getElementById('percent100').checked = true;
            } else {
                document.getElementById('percent50').checked = true;
            }
        }
        
        // Formatar data para exibi√ß√£o
        function formatDate(date) {
            const day = String(date.getDate()).padStart(2, '0');
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const year = date.getFullYear();
            return `${day}/${month}/${year}`;
        }
        
        // Configurar event listeners
        function setupEventListeners() {
            // Adicionar hora extra
            document.getElementById('add-overtime').addEventListener('click', function() {
                addOvertime();
            });
            
            // Limpar todas as horas extras
            document.getElementById('clear-all').addEventListener('click', function() {
                clearAllOvertime();
            });
            
            // Calcular ao alterar qualquer campo
            document.getElementById('salary').addEventListener('input', calculate);
            
            // Toggle modo escuro
            document.getElementById('theme-toggle').addEventListener('click', toggleDarkMode);
            
            // Toggle detalhes do c√°lculo
            document.getElementById('calculation-toggle').addEventListener('click', toggleCalculationDetails);
            
            // Hist√≥rico
            document.getElementById('view-history').addEventListener('click', showHistory);
            document.getElementById('clear-history').addEventListener('click', clearHistory);
        }
        
        // Alternar modo escuro
        function toggleDarkMode() {
            isDarkMode = !isDarkMode;
            document.body.classList.toggle('dark-mode', isDarkMode);
            document.getElementById('theme-toggle').textContent = isDarkMode ? '‚òÄÔ∏è Modo Claro' : 'üåô Modo Escuro';
        }
        
        // Alternar detalhes do c√°lculo
        function toggleCalculationDetails() {
            const content = document.getElementById('calculation-details');
            const arrow = document.getElementById('calculation-arrow');
            
            content.classList.toggle('expanded');
            content.classList.toggle('collapsed');
            arrow.textContent = content.classList.contains('expanded') ? '‚ñº' : '‚ñ∂';
        }
        
        // Salvar dados no localStorage
        function saveToLocalStorage() {
            const data = {
                overtimeEntries: overtimeEntries,
                salary: document.getElementById('salary').value
            };
            localStorage.setItem('overtimeCalculatorData', JSON.stringify(data));
        }
        
        // Carregar dados do localStorage
        function loadFromLocalStorage() {
            const savedData = localStorage.getItem('overtimeCalculatorData');
            if (savedData) {
                const data = JSON.parse(savedData);
                overtimeEntries = data.overtimeEntries || [];
                document.getElementById('salary').value = data.salary || '';
                
                if (overtimeEntries.length > 0) {
                    updateOvertimeList();
                    calculate();
                }
            }
        }
        
        // Calcular data de pagamento (L√ìGICA CORRIGIDA)
        function calculatePaymentDate(entryDate) {
            const day = entryDate.getDate();
            const month = entryDate.getMonth();
            const year = entryDate.getFullYear();
            
            // Se for ap√≥s o dia 25, pagamento ser√° no PR√ìXIMO M√äS
            if (day > 25) {
                // Pr√≥ximo m√™s
                let paymentMonth = month + 1;
                let paymentYear = year;
                
                // Se for dezembro, vai para janeiro do pr√≥ximo ano
                if (paymentMonth > 11) {
                    paymentMonth = 0;
                    paymentYear = year + 1;
                }
                
                // 5¬∫ dia √∫til do PR√ìXIMO m√™s
                return getFifthBusinessDay(paymentMonth, paymentYear);
            } else {
                // 5¬∫ dia √∫til deste m√™s
                return getFifthBusinessDay(month, year);
            }
        }
        
        // Encontrar o 5¬∫ dia √∫til do m√™s
        function getFifthBusinessDay(month, year) {
            let businessDays = 0;
            let currentDate = new Date(year, month, 1);
            
            while (businessDays < 5) {
                if (currentDate.getDay() !== 0 && currentDate.getDay() !== 6) {
                    businessDays++;
                }
                if (businessDays < 5) {
                    currentDate.setDate(currentDate.getDate() + 1);
                }
            }
            
            return currentDate;
        }
        
        // Mostrar alerta de pagamento
        function showPaymentAlert() {
            const alertBox = document.getElementById('payment-alert');
            const alertMessage = document.getElementById('alert-message');
            
            if (overtimeEntries.length === 0) {
                alertBox.style.display = 'none';
                return;
            }
            
            let nextPayment = null;
            let alertText = '';
            
            overtimeEntries.forEach(entry => {
                if (!nextPayment || entry.paymentDate < nextPayment) {
                    nextPayment = entry.paymentDate;
                }
            });
            
            if (nextPayment) {
                const today = new Date();
                const daysUntilPayment = Math.ceil((nextPayment - today) / (1000 * 60 * 60 * 24));
                
                if (daysUntilPayment <= 7) {
                    alertText = `Seu pr√≥ximo pagamento de horas extras ser√° em <strong>${formatDate(nextPayment)}</strong> (${daysUntilPayment} dias)`;
                    alertBox.style.display = 'block';
                } else {
                    alertText = `Seu pr√≥ximo pagamento de horas extras ser√° em <strong>${formatDate(nextPayment)}</strong>`;
                    alertBox.style.display = 'block';
                }
                
                alertMessage.innerHTML = alertText;
            }
        }
        
        // Atualizar informa√ß√µes de pagamento
        function updatePaymentInfo() {
            const paymentInfoBox = document.getElementById('payment-info-box');
            const paymentDetails = document.getElementById('payment-details');
            
            if (overtimeEntries.length === 0) {
                paymentDetails.textContent = 'Adicione horas extras para ver as informa√ß√µes de pagamento';
                return;
            }
            
            let paymentText = '';
            let paymentsByMonth = {};
            
            // Agrupar pagamentos por m√™s
            overtimeEntries.forEach((entry) => {
                const paymentDate = calculatePaymentDate(entry.date);
                const paymentKey = `${paymentDate.getFullYear()}-${paymentDate.getMonth()}`;
                
                if (!paymentsByMonth[paymentKey]) {
                    paymentsByMonth[paymentKey] = {
                        date: paymentDate,
                        entries: []
                    };
                }
                paymentsByMonth[paymentKey].entries.push(entry);
            });
            
            // Ordenar por data
            const sortedMonths = Object.values(paymentsByMonth).sort((a, b) => a.date - b.date);
            
            sortedMonths.forEach(monthData => {
                const paymentStr = formatDate(monthData.date);
                const totalHours = monthData.entries.reduce((sum, entry) => sum + entry.hours, 0);
                const totalValue = monthData.entries.reduce((sum, entry) => {
                    const hourValue = parseFloat(document.getElementById('salary').value) / 220;
                    const overtimeValue = hourValue * (1 + entry.percent / 100);
                    return sum + (overtimeValue * entry.hours);
                }, 0);
                
                paymentText += `
                    <div style="margin-bottom: 10px;">
                        <strong>${paymentStr}:</strong><br>
                        ‚Ä¢ ${totalHours.toFixed(2)} horas extras<br>
                        ‚Ä¢ Valor: ${formatCurrency(totalValue)}
                    </div>
                `;
            });
            
            paymentDetails.innerHTML = paymentText;
            showPaymentAlert();
        }
        
        // Adicionar hora extra √† lista
        function addOvertime() {
            const salary = parseFloat(document.getElementById('salary').value);
            const hours = parseInt(document.getElementById('hours').value) || 0;
            const minutes = parseInt(document.getElementById('minutes').value) || 0;
            const percent = document.querySelector('input[name="percent"]:checked').value;
            
            if (!salary || (!hours && !minutes) || !selectedDate) {
                alert('Por favor, preencha todos os campos obrigat√≥rios.');
                return;
            }
            
            // Converter horas e minutos para horas decimais
            const totalHours = hours + (minutes / 60);
            
            if (totalHours <= 0) {
                alert('Por favor, informe uma quantidade v√°lida de horas.');
                return;
            }
            
            // Verificar se √© fim de semana ou feriado para definir o percentual correto
            const dayOfWeek = selectedDate.getDay();
            const isWeekend = dayOfWeek === 0 || dayOfWeek === 6;
            const actualPercent = isWeekend ? 100 : parseInt(percent);
            
            // Calcular data de pagamento
            const paymentDate = calculatePaymentDate(selectedDate);
            
            // Adicionar √† lista
            overtimeEntries.push({
                date: new Date(selectedDate),
                hours: totalHours,
                hoursDisplay: hours,
                minutesDisplay: minutes,
                percent: actualPercent,
                isWeekend: isWeekend,
                paymentDate: paymentDate,
                timestamp: new Date().getTime()
            });
            
            updateOvertimeList();
            calculate();
            saveToLocalStorage();
            
            // Limpar campos
            document.getElementById('hours').value = '';
            document.getElementById('minutes').value = '';
        }
        
        // Atualizar lista de horas extras
        function updateOvertimeList() {
            const overtimeList = document.getElementById('overtime-list');
            overtimeList.innerHTML = '';
            
            if (overtimeEntries.length === 0) {
                overtimeList.innerHTML = '<p style="text-align: center; color: #777;">Nenhuma hora extra adicionada</p>';
                return;
            }
            
            // Ordenar por data
            overtimeEntries.sort((a, b) => a.date - b.date);
            
            overtimeEntries.forEach((entry, index) => {
                const item = document.createElement('div');
                item.className = 'overtime-item';
                
                const dateStr = formatDate(entry.date);
                const paymentStr = formatDate(entry.paymentDate);
                const percentStr = entry.percent === 100 ? '100% (Fim de semana)' : '50% (Dia de semana)';
                const timeStr = formatTime(entry.hoursDisplay, entry.minutesDisplay);
                
                item.innerHTML = `
                    <div>
                        <strong>${dateStr}</strong> - ${timeStr} (${percentStr})
                        <div class="month-warning">Pagamento: ${paymentStr}</div>
                    </div>
                    <button class="btn-danger" data-index="${index}">Remover</button>
                `;
                
                overtimeList.appendChild(item);
            });
            
            // Adicionar event listeners aos bot√µes de remover
            document.querySelectorAll('#overtime-list .btn-danger').forEach(button => {
                button.addEventListener('click', function() {
                    const index = parseInt(this.getAttribute('data-index'));
                    removeOvertime(index);
                });
            });
            
            // Atualizar informa√ß√µes de pagamento
            updatePaymentInfo();
        }
        
        // Formatar tempo para exibi√ß√£o
        function formatTime(hours, minutes) {
            if (minutes === 0) {
                return `${hours}h`;
            } else if (hours === 0) {
                return `${minutes}min`;
            } else {
                return `${hours}h${minutes.toString().padStart(2, '0')}min`;
            }
        }
        
        // Remover hora extra da lista
        function removeOvertime(index) {
            overtimeEntries.splice(index, 1);
            updateOvertimeList();
            calculate();
            saveToLocalStorage();
        }
        
        // Limpar todas as horas extras
        function clearAllOvertime() {
            overtimeEntries = [];
            updateOvertimeList();
            calculate();
            saveToLocalStorage();
        }
        
        // Mostrar hist√≥rico
        function showHistory() {
            const historyContent = document.getElementById('history-content');
            
            if (overtimeEntries.length === 0) {
                historyContent.innerHTML = '<p style="text-align: center; color: #777;">Nenhum hist√≥rico dispon√≠vel</p>';
                return;
            }
            
            // Agrupar por m√™s/ano
            let historyByMonth = {};
            
            overtimeEntries.forEach(entry => {
                const monthYear = `${entry.date.getMonth() + 1}/${entry.date.getFullYear()}`;
                if (!historyByMonth[monthYear]) {
                    historyByMonth[monthYear] = [];
                }
                historyByMonth[monthYear].push(entry);
            });
            
            let historyHTML = '';
            
            // Ordenar meses do mais recente para o mais antigo
            const sortedMonths = Object.keys(historyByMonth).sort((a, b) => {
                const [monthA, yearA] = a.split('/').map(Number);
                const [monthB, yearB] = b.split('/').map(Number);
                return new Date(yearB, monthB - 1) - new Date(yearA, monthA - 1);
            });
            
            sortedMonths.forEach(monthYear => {
                const entries = historyByMonth[monthYear];
                const totalHours = entries.reduce((sum, entry) => sum + entry.hours, 0);
                const totalValue = entries.reduce((sum, entry) => {
                    const hourValue = parseFloat(document.getElementById('salary').value) / 220;
                    const overtimeValue = hourValue * (1 + entry.percent / 100);
                    return sum + (overtimeValue * entry.hours);
                }, 0);
                
                historyHTML += `
                    <div class="history-item">
                        <strong>${monthYear}</strong><br>
                        Total: ${totalHours.toFixed(2)} horas - ${formatCurrency(totalValue)}<br>
                        <small>${entries.length} registro(s)</small>
                    </div>
                `;
            });
            
            historyContent.innerHTML = historyHTML;
        }
        
        // Limpar hist√≥rico
        function clearHistory() {
            if (confirm('Tem certeza que deseja limpar todo o hist√≥rico?')) {
                overtimeEntries = [];
                localStorage.removeItem('overtimeCalculatorData');
                updateOvertimeList();
                calculate();
                showHistory();
            }
        }
        
        // Calcular totais
        function calculate() {
            if (overtimeEntries.length === 0) {
                document.getElementById('result').style.display = 'none';
                return;
            }
            
            const salary = parseFloat(document.getElementById('salary').value) || 0;
            
            // Calcular valor da hora normal
            const hoursPerMonth = 220; // Padr√£o de 44h semanais
            const hourValue = salary / hoursPerMonth;
            
            // Calcular totais de horas extras
            let totalOvertimeHours = 0;
            let totalOvertimeValue = 0;
            
            overtimeEntries.forEach(entry => {
                totalOvertimeHours += entry.hours;
                const overtimeValue = hourValue * (1 + entry.percent / 100);
                totalOvertimeValue += overtimeValue * entry.hours;
            });
            
            // Calcular totais
            const totalBruto = salary + totalOvertimeValue;
            
            // C√ÅLCULOS CORRIGIDOS - ADIANTAMENTO APENAS SOBRE SAL√ÅRIO BRUTO
            const adiantamento = salary * 0.4;
            
            // C√°lculo do INSS (tabela 2024 CORRIGIDA)
            let inss = calculateINSS(totalBruto);
            
            // C√°lculo do IRRF (tabela 2024 CORRIGIDA)
            let ir = calculateIRRF(totalBruto, inss);
            
            // Calcular total l√≠quido
            const totalLiquido = totalBruto - adiantamento - inss - ir;
            
            // Atualizar a interface com os resultados
            document.getElementById('normal-hour-value').textContent = formatCurrency(hourValue);
            document.getElementById('total-overtime-hours').textContent = `${totalOvertimeHours.toFixed(2)} horas`;
            document.getElementById('total-bruto-overtime').textContent = formatCurrency(totalOvertimeValue);
            document.getElementById('total-bruto').textContent = formatCurrency(totalBruto);
            document.getElementById('adiantamento').textContent = formatCurrency(adiantamento);
            document.getElementById('inss').textContent = formatCurrency(inss);
            document.getElementById('ir').textContent = formatCurrency(ir);
            document.getElementById('total-liquido').textContent = formatCurrency(totalLiquido);
            
            // Mostrar detalhes do c√°lculo
            showCalculationDetails(salary, hourValue, totalOvertimeValue, totalBruto, adiantamento, inss, ir, totalLiquido);
            
            // Exibir resultado
            document.getElementById('result').style.display = 'block';
        }
        
        // Fun√ß√£o para mostrar detalhes do c√°lculo
        function showCalculationDetails(salary, hourValue, totalOvertimeValue, totalBruto, adiantamento, inss, ir, totalLiquido) {
            const details = document.getElementById('calculation-details');
            details.innerHTML = `
                <p><strong>1. Hora Normal:</strong> R$ ${salary.toFixed(2)} √∑ 220h = R$ ${hourValue.toFixed(2)}</p>
                <p><strong>2. Horas Extras:</strong> R$ ${totalOvertimeValue.toFixed(2)}</p>
                <p><strong>3. Total Bruto:</strong> R$ ${salary.toFixed(2)} + R$ ${totalOvertimeValue.toFixed(2)} = R$ ${totalBruto.toFixed(2)}</p>
                <p><strong>4. Adiantamento (40% sobre sal√°rio):</strong> R$ ${salary.toFixed(2)} √ó 40% = R$ ${adiantamento.toFixed(2)}</p>
                <p><strong>5. INSS:</strong> R$ ${inss.toFixed(2)}</p>
                <p><strong>6. IRRF:</strong> R$ ${ir.toFixed(2)}</p>
                <p><strong>7. Total L√≠quido:</strong> R$ ${totalBruto.toFixed(2)} - R$ ${(adiantamento + inss + ir).toFixed(2)} = R$ ${totalLiquido.toFixed(2)}</p>
            `;
        }
        
        // Fun√ß√£o para calcular INSS (TABELA 2024 CORRIGIDA)
        function calculateINSS(totalBruto) {
            let inss = 0;
            
            // Tabela INSS 2024 - C√ÅLCULO PROGRESSIVO CORRETO
            if (totalBruto <= 1412.00) {
                inss = totalBruto * 0.075;
            } else if (totalBruto <= 2666.68) {
                inss = (1412.00 * 0.075) + ((totalBruto - 1412.00) * 0.09);
            } else if (totalBruto <= 4000.03) {
                inss = (1412.00 * 0.075) + 
                       ((2666.68 - 1412.00) * 0.09) + 
                       ((totalBruto - 2666.68) * 0.12);
            } else if (totalBruto <= 7786.02) {
                inss = (1412.00 * 0.075) + 
                       ((2666.68 - 1412.00) * 0.09) + 
                       ((4000.03 - 2666.68) * 0.12) + 
                       ((totalBruto - 4000.03) * 0.14);
            } else {
                // Teto do INSS 2024
                inss = (1412.00 * 0.075) + 
                       ((2666.68 - 1412.00) * 0.09) + 
                       ((4000.03 - 2666.68) * 0.12) + 
                       ((7786.02 - 4000.03) * 0.14);
            }
            
            return Math.min(inss, 908.85); // N√£o pode ultrapassar o teto
        }
        
        // Fun√ß√£o para calcular IRRF (TABELA 2024 CORRIGIDA)
        function calculateIRRF(totalBruto, inss) {
            const baseIR = totalBruto - inss;
            const deducaoDependente = 189.59;
            const numeroDependentes = 0;
            
            const baseCalculo = baseIR - (numeroDependentes * deducaoDependente);
            let ir = 0;
            
            // Tabela IRRF 2024 - C√ÅLCULO CORRETO
            if (baseCalculo <= 2259.20) {
                ir = 0;
            } else if (baseCalculo <= 2826.65) {
                ir = baseCalculo * 0.075 - 169.44;
            } else if (baseCalculo <= 3751.05) {
                ir = baseCalculo * 0.15 - 381.44;
            } else if (baseCalculo <= 4664.68) {
                ir = baseCalculo * 0.225 - 662.77;
            } else {
                ir = baseCalculo * 0.275 - 896.00;
            }
            
            return Math.max(ir, 0);
        }
        
        // Fun√ß√£o para formatar valores em moeda
        function formatCurrency(value) {
            return 'R$ ' + value.toFixed(2).replace('.', ',');
        }
    </script>
</body>
</html>